from typing import Tuple, Optional
from sqlalchemy.orm import Session
from pydantic import BaseModel

from app.database.db import Base

def get_or_create(db: Session, model: Base, **kwargs) -> BaseModel:
  instance = db.query(model).filter_by(**kwargs).one_or_none()
  if instance:
    return instance

  instance = model(**kwargs)
  db.add(instance)
  db.commit()
  db.refresh(instance)
  return instance
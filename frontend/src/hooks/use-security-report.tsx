import useSWR from "swr";

import { GET_FULL_REPORT_BY_QUERY_ID } from "@/constants/api/security-report"
import { fetcher } from "@/lib/fetcher"
import { IFullSecurityReport } from "@/types/report/security-report";

interface UseSecurityReportProps {
  dbJobId?: string,
  glJobId?: string,
}

const useSecurityReport = ({
  dbJobId = undefined,
  glJobId = undefined,
}: UseSecurityReportProps) => {
  const query = dbJobId !== undefined
    ? `?db_job_id=${dbJobId}`
    : `?gl_job_id=${glJobId}`
  const apiUrl = `${GET_FULL_REPORT_BY_QUERY_ID}${query}`

  const { data, error, isLoading } = useSWR<IFullSecurityReport>(
    apiUrl,
    fetcher,
  )

  return {
    securityReport: data,
    isError: error,
    error,
    isLoading,
  }
}

export { useSecurityReport }

import useSWR from "swr";

import { IStatusScanJob } from "@/types/workers-status/status-scan-job"
import {
  GET_STATUS_SCAN_JOB_BY_DB_JOB_ID,
  GET_STATUS_SCAN_JOB_BY_GL_JOB_ID,
} from "@/constants/api/workers-status"
import { fetcher } from "@/lib/fetcher"

interface UseStatusScanJobProps {
  dbJobId?: string,
  glJobId?: string,
}

const useStatusScanJob = ({
  dbJobId = undefined,
  glJobId = undefined,
}: UseStatusScanJobProps) => {
  const apiUrl = dbJobId !== undefined 
    ? `${GET_STATUS_SCAN_JOB_BY_DB_JOB_ID}/${dbJobId}`
    : `${GET_STATUS_SCAN_JOB_BY_GL_JOB_ID}/${glJobId}`

  const { data, error, isLoading } = useSWR<IStatusScanJob>(
    apiUrl,
    fetcher,
  )

  return {
    statusScanJob: data,
    isError: error,
    error,
    isLoading,
  }
}

export { useStatusScanJob }

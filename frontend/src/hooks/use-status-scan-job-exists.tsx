import useSWR from "swr";

import {
  CHECK_STATUS_SCAN_JOB_EXISTS_BY_QUERY_ID,
} from "@/constants/api/workers-status"
import { fetcher } from "@/lib/fetcher"

interface UseStatusScanJobExistsProps {
  dbJobId?: string,
  glJobId?: string,
}

const useStatusScanJobExists = ({
  dbJobId = undefined,
  glJobId = undefined,
}: UseStatusScanJobExistsProps) => {
  const query = new URLSearchParams({})
  if (dbJobId !== undefined) query.append("db_job_id", dbJobId)
  if (glJobId !== undefined) query.append("gl_job_id", glJobId)
  const apiUrl = `${CHECK_STATUS_SCAN_JOB_EXISTS_BY_QUERY_ID}?` + query.toString()

  const { data, error, isLoading } = useSWR<boolean>(
    apiUrl,
    fetcher,
  )

  return {
    statusScanJobExists: data,
    isError: error,
    error,
    isLoading,
  }
}

export { useStatusScanJobExists }

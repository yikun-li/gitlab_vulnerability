import { cn } from "@/lib/utils"
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
} from "@/components/ui/card"
import { Separator } from "@/components/ui/separator"

import { IFullSecurityReport } from "@/types/report/security-report"
import { PageTitle } from "@/components/shared/animations/page-header"
import { TypographyH3 } from "@/components/shared/typography/typography-h3"
import SecurityReportDataCardContent from "./security-report-data-card-content"
import SecurityReportErrorCardContent from "./security-report-error-card-content"

interface SecurityReportCardProps extends React.ComponentProps<typeof Card> {
  securityReport?: IFullSecurityReport
  isLoading: boolean
  isError: boolean
}

const SecurityReportCard = ({
  securityReport,
  isLoading,
  isError,
  className,
  ...props
}: SecurityReportCardProps) => {

  return (
    <Card className={cn("w-full", className)} {...props}>
      <CardHeader className="space-y-3 pb-0">
        <PageTitle 
          title="Security Report"
          isLoading={isLoading}
          loadingTitle="Security Report"
          headingElement={TypographyH3}
          underline={false}
        />
        <CardDescription className="leading-5">Generated security report artifact furnished for GitLab.</CardDescription>
        <Separator />
      </CardHeader>
      <CardContent>
        {!isLoading && !isError && securityReport !== undefined
          ? <SecurityReportDataCardContent securityReport={securityReport} />
          : <SecurityReportErrorCardContent isLoading={isLoading} isError={isError} />
        }
      </CardContent>
    </Card>
  )
}

export { SecurityReportCard }